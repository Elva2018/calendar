<<<<<<< Updated upstream
﻿<!DOCTYPE html>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script src="https://cdn.staticfile.org/react/16.4.0/umd/react.development.js"></script>
<script src="https://cdn.staticfile.org/react-dom/16.4.0/umd/react-dom.development.js"></script>
<script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>
<!-- <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
<script src="https://unpkg.com/react@15/dist/react.js"></script>
<script src="https://unpkg.com/react-dom@15/dist/react-dom.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/6.1.19/browser.js"></script> -->
<link rel="stylesheet" type="text/css" href="css/initial.css" />


<style type="text/css">


.hide{display:none;}
.show{display:block;}
.w70{width:70px;}
.w100{width:100px;}
.inputBox{
	margin: 20px 5px 0px 20px;
}

.inputTextbox{
	width: 125px;
    height: 30px;
    line-height: 30px;
    border: 1px #0066b3 solid;
    padding: 0 9px;
    background: url(images/icon_24_date.png) right 3px no-repeat;
}

.dateRng{
	
	width: 502px;
    border: 1px solid grey; 
	margin: 0px 5px 0px 20px;
}
.calendarContainer{
	padding-left:5px;
	padding-right:5px;
	
}
.headerborder{
	position: relative;
	padding-top:3px;
	padding-bottom:8px;
	border-top: 6px solid darkblue;
	border-bottom: 2px solid darkblue;
}

.headerborder p{
	text-align: center;
	margin-top:3px;
}
.selectYM{
	height: 32px;
    width: auto;
    
    margin-left: 163px;
}
.pbd_select {
    /*display: inline-block;*/
    height: 30px;
    position: relative;
	margin:5px auto;
    z-index: 1;
    font-family: 微软雅黑;
    font-size: 14px;
    border-width: 1px;
    border-style: solid;
    border-color: rgb(0, 102, 179);
    border-image: initial;
	float:left;
	margin-right: 10px;
}
.pbd_select p {
    padding-right: 32px;
    height: 30px;
    line-height: 30px;
    background: url(images/icon_down.png) no-repeat right center;
    cursor: pointer;
    overflow: hidden;
    margin: 0 !important;
}
.pbd_select span {
    display: block;
    height: 31px;
    line-height: 31px;
    padding: 0px 6px;
    background-color: #fff;
    color: #bbb;
}
.pbd_select ul {
    overflow: auto;
    max-height: 160px;
    border: 1px solid #999;
    border-top: 0;
    width: 100%;
    position: absolute;
    left: -1px;
    top: 31px;
    background: #fff;
    margin: 0 !important;
    padding: 0 !important;
    box-shadow: 1px 1px 3px #d4d4d4;
    -moz-box-shadow: 1px 1px 3px #d4d4d4;
    -ms-box-shadow: 1px 1px 3px #d4d4d4;
    -o-box-shadow: 1px 1px 3px #d4d4d4;
    -webkit-box-shadow: 1px 1px 3px #d4d4d4;
}
.pbd_select ul li {
    display: block;
    padding-left: 6px;
    line-height: 24px;
    cursor: pointer;
    color: #333;
}
.pbd_select ul li:hover {
	background: #ededed;
}
.pbd_select span.fc_black {
    color: #333;
}
.headerborder .triangle-left span,
.headerborder .triangle-right span{
	font-size:12px;
	color: grey;
	font-weight: 100;
	font-style:italic;
}
.headerborder .triangle-left,
.headerborder .triangle-right{
	position: absolute;
	height: 30px;
	width: 80px;
	font-size: 20px;
	font-style: bold;
	color:grey;
	font-weight:800;
	cursor:pointer;
}
.headerborder .triangle-left:hover,
.headerborder .triangle-right:hover{
	font-weight:1000;
	color:blue;
	font-size:25px;
}
.headerborder .triangle-left{
	/*background: blue;*/	
	top: 3px;
	left: 20px;
	
}
.headerborder .triangle-right{
	
	/*background: blue;*/
	
	top: 3px;
	right: 20px;

	
}
.weekday{
	height: 40px;
}
.weekday ul{
	height: 100%;
	width: 100%;

}

.weekday ul li{
	float: left;
	line-height:40px;
	width: 70px;
	text-align:center;
	line-height:40px;
}
.CalendarDay{
	
}

.CalendarDay ul{
	width: 100%;

}

.CalendarDay ul li{
	float: left;
	width:70px;
	text-align:center;
	color: gray;
	height: 60px;
	line-height:60px;
	cursor: pointer;
}
.CalendarDay ul li:hover{background:#D7D9C4;}
.CalendarDay ul li.date_select{background:#D7D9C4;}


.selectDateShowUp{
	clear: both;
}
.selectDateShowUp p{
	text-align: center;
}
</style>


<script type="text/babel">

	
		
		class MyComponent extends React.Component {

			constructor(props) {
					super(props);
					this.state = {
						/*s_year:this.props.s_year,
						s_month:this.props.s_month,
						s_day:this.props.day,
						monthKey:this.props.monthKey,
						inputTxt: this.props.inputTxt*/

						};	
			}
		
		  handleClick(){
    
			this.refs.myInput.focus();
			//this.refs.myInput.className = 'show';
		  }
		  
		  render(){
			
			return (
			  <div className="inputBox">
				<input type="text" ref="myInput" className="inputTextbox"
				value={this.props.inputTxt}
				onChange={this.props.updateStateProp}
				onClick={this.props.dateRngShow}
				
				/>
				<input
				  
				  type="button"
				  value="点击获取焦点"
				  onClick={this.handleClick.bind(this)}
				/>
			  </div>
			);
		  }
		}
 


		class CalendarHeader extends React.Component {
			
			constructor(props) {
				super(props);
				
				this.state = {
					year:this.props.year,
					month:this.props.month,
					day:this.props.day,
					display_class1: 'hide',
					display_class2: 'hide',
					font_class:'',
					s_month: this.props.s_month,
					s_year: this.props.s_year,
					monthKey: this.props.monthKey,
					

					};
				this.toggleClick1 = this.toggleClick1.bind(this);
				this.toggleClick2 = this.toggleClick2.bind(this);
				//this.dateSelect = this.dateSelect.bind(this);
				this.handleLeftClick = this.handleLeftClick.bind(this);
				this.handleRightClick = this.handleRightClick.bind(this);
			}
			

			toggleClick1(){
					this.setState({
						display_class1: this.state.display_class1 == 'hide' ? 'show': 'hide'
					
					});
			}
			toggleClick2(){
					this.setState({
						display_class2: this.state.display_class2 == 'hide' ? 'show': 'hide'
					
					});
			}
			

			handleLeftClick(){
				var newMonth = this.props.month ==1 ? 12 : this.props.month-1;
				var year = this.props.month ==1 ? this.props.year-1 : this.props.year;
				/*this.setState({
					s_month:newMonth
			    });*/
			    
				this.props.updateFilter(year,newMonth,1);
				this.props.updateMonthKey('c');

				
			}
			handleRightClick(){
				var newMonth = this.props.month ==12 ? 1 : this.props.month+1;
				var year = this.props.month ==12 ? this.props.year+1 : this.props.year;
				/*this.setState({
					s_month:newMonth
			  });*/
				this.props.updateFilter(year,newMonth,1);
				this.props.updateMonthKey('c');
			}
			monthSelect(s_month) {
				
				//let { select_year, select_month} = this.state;
				this.setState({
					month: s_month,
					font_class : 'fc_black',
					display_class2: 'hide',
					//s_month:s_month
				});
				this.props.updateFilter(this.props.year,s_month,1);

			}
			yearSelect(s_year) {
				
				this.setState({
					year: s_year,
					font_class : 'fc_black',
					display_class1: 'hide',
					//s_month:s_month
				});
				this.props.updateFilter(s_year,this.props.month,1);
				
				
			}
			render(){

				//头部日期选择下拉框
				var arrym=[],arryYear=[];
				for(var i = 0 ;i < 12; i++ ){
					arrym[i] = i+1;
				}
				var mNode = arrym.map((mItem)=> 
					<li onClick={() =>this.monthSelect(mItem)}>
					 {mItem}月
					</li>
				);
				
				for(var i = this.props.year - 5 ;i < this.props.year + 5; i++ ){
					arryYear[i] = i;
				}
				var yNode = arryYear.map((yItem)=> 
					<li onClick={() =>this.yearSelect(yItem)}>
					 {yItem}年
					</li>
			
				);

				var arrowLeft = '<--';
				var arrowRight = '-->';

				const display_class = this.state.display_class=='hide' ? 'show' : 'hide';
				return(
					<div className="headerborder">

					<div className="selectYM">
						<div className="pbd_select w100" onClick={this.toggleClick1}>
							<p><span className={this.state.font_class}>{this.props.year}年</span></p>
							<ul className={this.state.display_class1}>
							  {yNode}
							</ul>
						</div>

						<div className="pbd_select w70" onClick={this.toggleClick2}>
							<p><span className={this.state.font_class}>{this.props.month}月</span></p>
							<ul className={this.state.display_class2}>
							  {mNode}
							</ul>
						</div>
					</div>	
						
						
						<p className="triangle-left" onClick={this.handleLeftClick}>{arrowLeft}<span>上个月</span></p>
						<p className="triangle-right" onClick={this.handleRightClick}><span>下个月</span>{arrowRight}</p>
					</div>
				);
			}
		}	
		class CalendarBody extends React.Component {
			constructor(props) {
				super(props);
				this.state = {
					year:this.props.year,
					month:this.props.month,
					day:this.props.day,
					monthKey: 'c',
					click_dateClass: '',
					s_year: this.props.s_year,
					s_month: this.props.s_month
					};
			this.handleWeekTxt = this.handleWeekTxt.bind(this);
			 }
			
			getMonthDays(year,month){
		       
				var temp = new Date(year,month,0); 
				return temp.getDate(); 
			}	
			getDayOfWeek(year,month,day){
                      
 
				var dt = new Date(year+'/'+month+'/'+day);//new Date(year,month,1);
				var Weekdays = dt.getDay();
			
				return Weekdays; 	
			}
			dateClick(s_year,s_month,s_day) {
				this.setState({
				click_dateClass: 'date_select'
				});
				
				//let { select_year, select_month} = this.state;
				
				this.props.updateFilter(this.props.year,this.props.month,s_day);
				if(s_month == this.props.month){
					//this.props.updateFilter(s_year,s_month,s_day);
					this.setState({
						monthKey:'c'
					
						});
					this.props.updateMonthKey('c');
					
				}

				if(s_month == this.props.month-1){
					//this.props.updateFilter(s_year,s_month+1,s_day);
					this.setState({
						monthKey:'pre'
					
						});
					this.props.updateMonthKey('pre');
				}
				if(s_month == this.props.month+1){
					//this.props.updateFilter(s_year,s_month-1,s_day);
					this.setState({
						monthKey:'next'
					
						});
					this.props.updateMonthKey('next');
				}
			}
			//星期中文显示
				handleWeekTxt =(curDayWeek)=>{
						switch (curDayWeek) {
						case 0 :
							return '日';
						case 1 :
							return '一';
						case 2 :
							return '二';
						case 3 :
							return '三';
						case 4 :
							return '四';
						case 5 :
							return '五';
						case 6 :
							return '六';
						default :
							return ''
					}
				};

			render(){

				var arry1 =[],arry2 = [],arry3 = [];
				var currentYear = this.props.year,currentMonth = this.props.month;
				var preMYear = currentMonth == 1 ? currentYear-1 : currentYear;
				var preMonth = currentMonth == 1 ? 12 : currentMonth-1;
				var nextMYear = currentMonth == 12 ? currentYear+1 : currentYear;
				var nextMonth = currentMonth == 12 ? 1 : currentMonth+1;

				var getCurMonthLength = this.getMonthDays(currentYear,currentMonth);
				var curFirstDayWeek = this.getDayOfWeek(currentYear,currentMonth,1);
				var curLastDayWeek = this.getDayOfWeek(currentYear,currentMonth,getCurMonthLength);

				var getPreMonthLength = this.getMonthDays(preMYear,preMonth);
				var getNextMonthLength = this.getMonthDays(nextMYear,nextMonth);

				var day = this.props.day;
				var selDayWeek = this.getDayOfWeek(this.props.s_year,this.props.s_month,this.props.day);
				var preFirstDay = getPreMonthLength - curFirstDayWeek+1;
				var today = new Date();

				

				if(curFirstDayWeek>0){
					for(var i = 0 ;i < curFirstDayWeek; i++ ){
						arry1[i] = preFirstDay + i;
					}
				}
				for(var i = 0 ;i < getCurMonthLength; i++ ){
					arry2[i] = (i+1);
				}
				if(6-curLastDayWeek>0){
					for(var i = 0 ;i < 6-curLastDayWeek; i++ ){
						arry3[i] = i+1;
					}
				}
				
				//日期选中的className
				var s_date_class = "date_select"
				var node1 = arry1.map((item,index)=> 
				<li key={index} className={(item==this.props.day & this.state.monthKey == "pre") ? s_date_class :  ''} 
				
				style={{"color": "#C27E5B"}} onClick={() => this.dateClick(preMYear,preMonth,item)}>
				 {item}
				</li>
				
				);

				var node2 = arry2.map((item,index)=>
				 (item == today.getDate() & currentMonth == today.getMonth()+1 & currentYear == today.getFullYear()) ?
				 <li style={{"background": "#95D7DA"}} onClick={() => this.dateClick(currentYear,currentMonth,item)}>{item}</li>
				 : <li key={index} className={(item==this.props.day & this.state.monthKey == "c") ? s_date_class :  ''} onClick={() => this.dateClick(currentYear,currentMonth,item)}>{item}</li>
				
				);
				
				var node3 = arry3.map((item,index)=> 
				
				<li key={index} className={(item==this.props.day & this.state.monthKey == "next")? s_date_class :  ''}
	
				style={{"color": "#C27E5B"}} onClick={() => this.dateClick(nextMYear,nextMonth,item)}>
				 {item}
				</li>
				);

				return(
					<div className="calendarContainer">
						<div className="weekday">
							<ul>		
								<li>SUN</li>
								<li>MON</li>
								<li>TUE</li>
								<li>WED</li>
								<li>THU</li>
								<li>FRI</li>
								<li>SAT</li>
							</ul>
						</div>
						<div className="CalendarDay">
							<ul>
								{node1}{node2}{node3}
								
							
							</ul>
						</div>

						<div className="selectDateShowUp">
							<p>你选择的日期是：
							{this.props.s_year}年{this.props.s_month}月{this.props.day}日
							
							</p>
							
							<p>星期{this.handleWeekTxt(selDayWeek)}</p>
						</div>
					</div>
				);
			}
		}
		class CalendarControl extends React.Component {

			constructor(props) {
				super(props);
				var newDate =  new Date();
				
				this.state = {
					year:newDate.getFullYear(),
					month:newDate.getMonth() +1,
					day: newDate.getDate(),
					monthKey: 'c',
					
					
					};
				this.handleFilterUpdate = this.handleFilterUpdate.bind(this);
				this.handleMonthKey = this.handleMonthKey.bind(this);
				this.handleChange = this.handleChange.bind(this);
				this.dateRngShow = this.dateRngShow.bind(this);
				
			}

			handleChange(e) {
				
				  this.setState({inputTxt: event.target.value});
				
			}
			
			handleMonthKey(filterMKey){
				

				this.setState({
				 monthKey: filterMKey,
				 
				});
			}

			handleFilterUpdate(filterYear,filterMonth,filterDay) {
				
				this.setState({
				 year: filterYear,
				 month: filterMonth,
				 day:filterDay
				
				});
			}

			//var s_year; var s_month;
			dateRngShow(){
					var dateRngClass = this.refs.dateRng.className;
					this.refs.dateRng.className = this.refs.dateRng.className=="hide" ? "dateRng" : "hide";
				  }
						
			
			render(){
				if(this.state.monthKey=='pre'){
				var s_year = this.state.month == 1 ? this.state.year-1 :this.state.year;
				var s_month = this.state.month == 1 ? 12 : this.state.month-1;
				}
				if(this.state.monthKey=='c'){
					var s_year = this.state.year;
					var s_month = this.state.month;
				}
				
				if(this.state.monthKey=='next'){
					var s_year = this.state.month == 12 ? this.state.year+1 : this.state.year;
					var s_month = this.state.month == 12 ? 1 : this.state.month+1;
				}
				//var inputTxt = s_year + "年" + s_month + "月" + this.state.day + "日";
				
				return(
					<div>
						 <MyComponent 
								
								inputTxt = {s_year + "-" + s_month + "-" + this.state.day}
								updateStateProp = {this.handleChange}
								dateRngShow = {this.dateRngShow}
								/>
						
						<div className="dateRng" ref="dateRng">
							<CalendarHeader  year = {this.state.year}
								month = {this.state.month}
								updateFilter={this.handleFilterUpdate} 
								updateMonthKey={this.handleMonthKey} />
							<CalendarBody  year = {this.state.year}
								month = {this.state.month}
								day = {this.state.day} 
								s_year={s_year}
								s_month={s_month}
								updateFilter={this.handleFilterUpdate}
								updateMonthKey={this.handleMonthKey}
								/>
						</div>
					</div>
				);
			}
	}	

		ReactDOM.render(
			 
			<CalendarControl />,
			document.getElementById("calbody")
		);


</script>
</head>

<body>



<div id="calbody">



</div>
</body>
=======
﻿<!DOCTYPE html>

<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
<script src="https://cdn.staticfile.org/react/16.4.0/umd/react.development.js"></script>
<script src="https://cdn.staticfile.org/react-dom/16.4.0/umd/react-dom.development.js"></script>
<script src="https://cdn.staticfile.org/babel-standalone/6.26.0/babel.min.js"></script>
<!-- <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script> -->
<script src="https://unpkg.com/react@15/dist/react.js"></script>
<script src="https://unpkg.com/react-dom@15/dist/react-dom.js"></script>
<!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/babel-core/6.1.19/browser.js"></script> -->
<link rel="stylesheet" type="text/css" href="css/initial.css" />


<style type="text/css">


.hide{display:none;}
.show{display:block;}
.w70{width:70px;}
.w100{width:100px;}
.inputBox{
	margin: 20px 5px 0px 20px;
}

.inputTextbox{
	width: 125px;
    height: 30px;
    line-height: 30px;
    border: 1px #0066b3 solid;
    padding: 0 9px;
    background: url(images/icon_24_date.png) right 3px no-repeat;
}

.dateRng{
	
	width: 502px;
    border: 1px solid grey; 
	margin: 0px 5px 0px 20px;
}
.calendarContainer{
	padding-left:5px;
	padding-right:5px;
	
}
.headerborder{
	position: relative;
	padding-top:3px;
	padding-bottom:8px;
	border-top: 6px solid darkblue;
	border-bottom: 2px solid darkblue;
}

.headerborder p{
	text-align: center;
	margin-top:3px;
}
.selectYM{
	height: 32px;
    width: auto;
    
    margin-left: 163px;
}
.pbd_select {
    /*display: inline-block;*/
    height: 30px;
    position: relative;
	margin:5px auto;
    z-index: 1;
    font-family: 微软雅黑;
    font-size: 14px;
    border-width: 1px;
    border-style: solid;
    border-color: rgb(0, 102, 179);
    border-image: initial;
	float:left;
	margin-right: 10px;
}
.pbd_select p {
    padding-right: 32px;
    height: 30px;
    line-height: 30px;
    background: url(images/icon_down.png) no-repeat right center;
    cursor: pointer;
    overflow: hidden;
    margin: 0 !important;
}
.pbd_select span {
    display: block;
    height: 31px;
    line-height: 31px;
    padding: 0px 6px;
    background-color: #fff;
    color: #bbb;
}
.pbd_select ul {
    overflow: auto;
    max-height: 160px;
    border: 1px solid #999;
    border-top: 0;
    width: 100%;
    position: absolute;
    left: -1px;
    top: 31px;
    background: #fff;
    margin: 0 !important;
    padding: 0 !important;
    box-shadow: 1px 1px 3px #d4d4d4;
    -moz-box-shadow: 1px 1px 3px #d4d4d4;
    -ms-box-shadow: 1px 1px 3px #d4d4d4;
    -o-box-shadow: 1px 1px 3px #d4d4d4;
    -webkit-box-shadow: 1px 1px 3px #d4d4d4;
}
.pbd_select ul li {
    display: block;
    padding-left: 6px;
    line-height: 24px;
    cursor: pointer;
    color: #333;
}
.pbd_select ul li:hover {
	background: #ededed;
}
.pbd_select span.fc_black {
    color: #333;
}
.headerborder .triangle-left span,
.headerborder .triangle-right span{
	font-size:12px;
	color: grey;
	font-weight: 100;
	font-style:italic;
}
.headerborder .triangle-left,
.headerborder .triangle-right{
	position: absolute;
	height: 30px;
	width: 80px;
	font-size: 20px;
	font-style: bold;
	color:grey;
	font-weight:800;
	cursor:pointer;
}
.headerborder .triangle-left:hover,
.headerborder .triangle-right:hover{
	font-weight:1000;
	color:blue;
	font-size:25px;
}
.headerborder .triangle-left{
	/*background: blue;*/	
	top: 3px;
	left: 20px;
	
}
.headerborder .triangle-right{
	
	/*background: blue;*/
	
	top: 3px;
	right: 20px;

	
}
.weekday{
	height: 40px;
}
.weekday ul{
	height: 100%;
	width: 100%;

}

.weekday ul li{
	float: left;
	line-height:40px;
	width: 70px;
	text-align:center;
	line-height:40px;
}
.CalendarDay{
	
}

.CalendarDay ul{
	width: 100%;

}

.CalendarDay ul li{
	float: left;
	width:70px;
	text-align:center;
	color: gray;
	height: 60px;
	line-height:60px;
	cursor: pointer;
}
.CalendarDay ul li:hover{background:#D7D9C4;}
.CalendarDay ul li.date_select{background:#D7D9C4;}


.selectDateShowUp{
	clear: both;
}
.selectDateShowUp p{
	text-align: center;
}
</style>


<script type="text/babel">

	
		
		class MyComponent extends React.Component {

			constructor(props) {
					super(props);
					this.state = {
						/*s_year:this.props.s_year,
						s_month:this.props.s_month,
						s_day:this.props.day,
						monthKey:this.props.monthKey,
						inputTxt: this.props.inputTxt*/

						};	
			}
		
		  handleClick(){
    
			this.refs.myInput.focus();
			//this.refs.myInput.className = 'show';
		  }
		  
		  render(){
			
			return (
			  <div className="inputBox">
				<input type="text" ref="myInput" className="inputTextbox"
				value={this.props.inputTxt}
				onChange={this.props.updateStateProp}
				onClick={this.props.dateRngShow}
				
				/>
				<input
				  
				  type="button"
				  value="点击获取焦点"
				  onClick={this.handleClick.bind(this)}
				/>
			  </div>
			);
		  }
		}
 


		class CalendarHeader extends React.Component {
			
			constructor(props) {
				super(props);
				
				this.state = {
					year:this.props.year,
					month:this.props.month,
					day:this.props.day,
					display_class1: 'hide',
					display_class2: 'hide',
					font_class:'',
					s_month: this.props.s_month,
					s_year: this.props.s_year,
					monthKey: this.props.monthKey,
					

					};
				this.toggleClick1 = this.toggleClick1.bind(this);
				this.toggleClick2 = this.toggleClick2.bind(this);
				//this.dateSelect = this.dateSelect.bind(this);
				this.handleLeftClick = this.handleLeftClick.bind(this);
				this.handleRightClick = this.handleRightClick.bind(this);
			}
			

			toggleClick1(){
					this.setState({
						display_class1: this.state.display_class1 == 'hide' ? 'show': 'hide'
					
					});
			}
			toggleClick2(){
					this.setState({
						display_class2: this.state.display_class2 == 'hide' ? 'show': 'hide'
					
					});
			}
			

			handleLeftClick(){
				var newMonth = this.props.month ==1 ? 12 : this.props.month-1;
				var year = this.props.month ==1 ? this.props.year-1 : this.props.year;
				/*this.setState({
					s_month:newMonth
			    });*/
			    
				this.props.updateFilter(year,newMonth,1);
				this.props.updateMonthKey('c');

				
			}
			handleRightClick(){
				var newMonth = this.props.month ==12 ? 1 : this.props.month+1;
				var year = this.props.month ==12 ? this.props.year+1 : this.props.year;
				/*this.setState({
					s_month:newMonth
			  });*/
				this.props.updateFilter(year,newMonth,1);
				this.props.updateMonthKey('c');
			}
			monthSelect(s_month) {
				
				//let { select_year, select_month} = this.state;
				this.setState({
					month: s_month,
					font_class : 'fc_black',
					display_class2: 'hide',
					//s_month:s_month
				});
				this.props.updateFilter(this.props.year,s_month,1);

			}
			yearSelect(s_year) {
				
				this.setState({
					year: s_year,
					font_class : 'fc_black',
					display_class1: 'hide',
					//s_month:s_month
				});
				this.props.updateFilter(s_year,this.props.month,1);
				
				
			}
			render(){

				//头部日期选择下拉框
				var arrym=[],arryYear=[];
				for(var i = 0 ;i < 12; i++ ){
					arrym[i] = i+1;
				}
				var mNode = arrym.map((mItem)=> 
					<li onClick={() =>this.monthSelect(mItem)}>
					 {mItem}月
					</li>
				);
				
				for(var i = this.props.year - 5 ;i < this.props.year + 5; i++ ){
					arryYear[i] = i;
				}
				var yNode = arryYear.map((yItem)=> 
					<li onClick={() =>this.yearSelect(yItem)}>
					 {yItem}年
					</li>
			
				);

				var arrowLeft = '<--';
				var arrowRight = '-->';

				const display_class = this.state.display_class=='hide' ? 'show' : 'hide';
				return(
					<div className="headerborder">

					<div className="selectYM">
						<div className="pbd_select w100" onClick={this.toggleClick1}>
							<p><span className={this.state.font_class}>{this.props.year}年</span></p>
							<ul className={this.state.display_class1}>
							  {yNode}
							</ul>
						</div>

						<div className="pbd_select w70" onClick={this.toggleClick2}>
							<p><span className={this.state.font_class}>{this.props.month}月</span></p>
							<ul className={this.state.display_class2}>
							  {mNode}
							</ul>
						</div>
					</div>	
						
						
						<p className="triangle-left" onClick={this.handleLeftClick}>{arrowLeft}<span>上个月</span></p>
						<p className="triangle-right" onClick={this.handleRightClick}><span>下个月</span>{arrowRight}</p>
					</div>
				);
			}
		}	
		class CalendarBody extends React.Component {
			constructor(props) {
				super(props);
				this.state = {
					year:this.props.year,
					month:this.props.month,
					day:this.props.day,
					monthKey: 'c',
					click_dateClass: '',
					s_year: this.props.s_year,
					s_month: this.props.s_month
					};
			this.handleWeekTxt = this.handleWeekTxt.bind(this);
			 }
			
			getMonthDays(year,month){
		       
				var temp = new Date(year,month,0); 
				return temp.getDate(); 
			}	
			getDayOfWeek(year,month,day){
                      
 
				var dt = new Date(year+'/'+month+'/'+day);//new Date(year,month,1);
				var Weekdays = dt.getDay();
			
				return Weekdays; 	
			}
			dateClick(s_year,s_month,s_day) {
				this.setState({
				click_dateClass: 'date_select'
				});
				
				//let { select_year, select_month} = this.state;
				
				this.props.updateFilter(this.props.year,this.props.month,s_day);
				if(s_month == this.props.month){
					//this.props.updateFilter(s_year,s_month,s_day);
					this.setState({
						monthKey:'c'
					
						});
					this.props.updateMonthKey('c');
					
				}

				if(s_month == this.props.month-1){
					//this.props.updateFilter(s_year,s_month+1,s_day);
					this.setState({
						monthKey:'pre'
					
						});
					this.props.updateMonthKey('pre');
				}
				if(s_month == this.props.month+1){
					//this.props.updateFilter(s_year,s_month-1,s_day);
					this.setState({
						monthKey:'next'
					
						});
					this.props.updateMonthKey('next');
				}
			}
			//星期中文显示
				handleWeekTxt =(curDayWeek)=>{
						switch (curDayWeek) {
						case 0 :
							return '日';
						case 1 :
							return '一';
						case 2 :
							return '二';
						case 3 :
							return '三';
						case 4 :
							return '四';
						case 5 :
							return '五';
						case 6 :
							return '六';
						default :
							return ''
					}
				};

			render(){

				var arry1 =[],arry2 = [],arry3 = [];
				var currentYear = this.props.year,currentMonth = this.props.month;
				var preMYear = currentMonth == 1 ? currentYear-1 : currentYear;
				var preMonth = currentMonth == 1 ? 12 : currentMonth-1;
				var nextMYear = currentMonth == 12 ? currentYear+1 : currentYear;
				var nextMonth = currentMonth == 12 ? 1 : currentMonth+1;

				var getCurMonthLength = this.getMonthDays(currentYear,currentMonth);
				var curFirstDayWeek = this.getDayOfWeek(currentYear,currentMonth,1);
				var curLastDayWeek = this.getDayOfWeek(currentYear,currentMonth,getCurMonthLength);

				var getPreMonthLength = this.getMonthDays(preMYear,preMonth);
				var getNextMonthLength = this.getMonthDays(nextMYear,nextMonth);

				var day = this.props.day;
				var selDayWeek = this.getDayOfWeek(this.props.s_year,this.props.s_month,this.props.day);
				var preFirstDay = getPreMonthLength - curFirstDayWeek+1;
				var today = new Date();

				

				if(curFirstDayWeek>0){
					for(var i = 0 ;i < curFirstDayWeek; i++ ){
						arry1[i] = preFirstDay + i;
					}
				}
				for(var i = 0 ;i < getCurMonthLength; i++ ){
					arry2[i] = (i+1);
				}
				if(6-curLastDayWeek>0){
					for(var i = 0 ;i < 6-curLastDayWeek; i++ ){
						arry3[i] = i+1;
					}
				}
				
				//日期选中的className
				var s_date_class = "date_select"
				var node1 = arry1.map((item,index)=> 
				<li key={index} className={(item==this.props.day & this.state.monthKey == "pre") ? s_date_class :  ''} 
				
				style={{"color": "#C27E5B"}} onClick={() => this.dateClick(preMYear,preMonth,item)}>
				 {item}
				</li>
				
				);

				var node2 = arry2.map((item,index)=>
				 (item == today.getDate() & currentMonth == today.getMonth()+1 & currentYear == today.getFullYear()) ?
				 <li style={{"background": "#95D7DA"}} onClick={() => this.dateClick(currentYear,currentMonth,item)}>{item}</li>
				 : <li key={index} className={(item==this.props.day & this.state.monthKey == "c") ? s_date_class :  ''} onClick={() => this.dateClick(currentYear,currentMonth,item)}>{item}</li>
				
				);
				
				var node3 = arry3.map((item,index)=> 
				
				<li key={index} className={(item==this.props.day & this.state.monthKey == "next")? s_date_class :  ''}
	
				style={{"color": "#C27E5B"}} onClick={() => this.dateClick(nextMYear,nextMonth,item)}>
				 {item}
				</li>
				);

				return(
					<div className="calendarContainer">
						<div className="weekday">
							<ul>		
								<li>SUN</li>
								<li>MON</li>
								<li>TUE</li>
								<li>WED</li>
								<li>THU</li>
								<li>FRI</li>
								<li>SAT</li>
							</ul>
						</div>
						<div className="CalendarDay">
							<ul>
								{node1}{node2}{node3}
								
							
							</ul>
						</div>

						<div className="selectDateShowUp">
							<p>你选择的日期是：
							{this.props.s_year}年{this.props.s_month}月{this.props.day}日
							
							</p>
							
							<p>星期{this.handleWeekTxt(selDayWeek)}</p>
						</div>
					</div>
				);
			}
		}
		class CalendarControl extends React.Component {

			constructor(props) {
				super(props);
				var newDate =  new Date();
				
				this.state = {
					year:newDate.getFullYear(),
					month:newDate.getMonth() +1,
					day: newDate.getDate(),
					monthKey: 'c',
					
					
					};
				this.handleFilterUpdate = this.handleFilterUpdate.bind(this);
				this.handleMonthKey = this.handleMonthKey.bind(this);
				this.handleChange = this.handleChange.bind(this);
				this.dateRngShow = this.dateRngShow.bind(this);
				
			}

			handleChange(e) {
				
				  this.setState({inputTxt: event.target.value});
				
			}
			
			handleMonthKey(filterMKey){
				

				this.setState({
				 monthKey: filterMKey,
				 
				});
			}

			handleFilterUpdate(filterYear,filterMonth,filterDay) {
				
				this.setState({
				 year: filterYear,
				 month: filterMonth,
				 day:filterDay
				
				});
			}

			//var s_year; var s_month;
			dateRngShow(){
					var dateRngClass = this.refs.dateRng.className;
					this.refs.dateRng.className = this.refs.dateRng.className=="hide" ? "dateRng" : "hide";
				  }
						
			
			render(){
				if(this.state.monthKey=='pre'){
				var s_year = this.state.month == 1 ? this.state.year-1 :this.state.year;
				var s_month = this.state.month == 1 ? 12 : this.state.month-1;
				}
				if(this.state.monthKey=='c'){
					var s_year = this.state.year;
					var s_month = this.state.month;
				}
				
				if(this.state.monthKey=='next'){
					var s_year = this.state.month == 12 ? this.state.year+1 : this.state.year;
					var s_month = this.state.month == 12 ? 1 : this.state.month+1;
				}
				//var inputTxt = s_year + "年" + s_month + "月" + this.state.day + "日";
				
				return(
					<div>
						 <MyComponent 
								
								inputTxt = {s_year + "-" + s_month + "-" + this.state.day}
								updateStateProp = {this.handleChange}
								dateRngShow = {this.dateRngShow}
								/>
						
						<div className="dateRng" ref="dateRng">
							<CalendarHeader  year = {this.state.year}
								month = {this.state.month}
								updateFilter={this.handleFilterUpdate} 
								updateMonthKey={this.handleMonthKey} />
							<CalendarBody  year = {this.state.year}
								month = {this.state.month}
								day = {this.state.day} 
								s_year={s_year}
								s_month={s_month}
								updateFilter={this.handleFilterUpdate}
								updateMonthKey={this.handleMonthKey}
								/>
						</div>
					</div>
				);
			}
	}	

		ReactDOM.render(
			 
			<CalendarControl />,
			document.getElementById("calbody")
		);


</script>
</head>

<body>



<div id="calbody">



</div>
</body>
>>>>>>> Stashed changes
</html>